var ts = require('typescript');
var logger_1 = require('./logger');
var utils_1 = require('./utils');
var logger = new logger_1.default({ debug: false });
exports.__HTML_MODULE__ = "__html_module__";
;
var CompilerHost = (function () {
    function CompilerHost(options) {
        this._options = options || {};
        this._options.module = this.getEnum(this._options.module, ts.ModuleKind, ts.ModuleKind.System);
        this._options.target = this.getEnum(this._options.target, ts.ScriptTarget, ts.ScriptTarget.ES5);
        this._options.jsx = this.getEnum(this._options.jsx, ts.JsxEmit, ts.JsxEmit.None);
        this._options.allowNonTsExtensions = (this._options.allowNonTsExtensions !== false);
        this._options.skipDefaultLibCheck = (this._options.skipDefaultLibCheck !== false);
        this._options.noResolve = true;
        this._files = new Map();
        this._fileResMaps = new Map();
        this.addFile(exports.__HTML_MODULE__, "var __html__: string = ''; export default __html__;");
    }
    CompilerHost.prototype.getEnum = function (enumValue, enumType, defaultValue) {
        if (enumValue == undefined)
            return defaultValue;
        for (var enumProp in enumType) {
            if (enumProp.toLowerCase() === enumValue.toString().toLowerCase()) {
                if (typeof enumType[enumProp] === "string")
                    return enumType[enumType[enumProp]];
                else
                    return enumType[enumProp];
            }
        }
        throw new Error("Unrecognised value [" + enumValue + "]");
    };
    Object.defineProperty(CompilerHost.prototype, "options", {
        get: function () {
            return this._options;
        },
        enumerable: true,
        configurable: true
    });
    CompilerHost.prototype.getSourceFile = function (fileName) {
        return this._files[fileName];
    };
    CompilerHost.prototype.fileExists = function (fileName) {
        return !!this._files[fileName];
    };
    CompilerHost.prototype.readFile = function (fileName) {
        throw new Error("Not implemented");
    };
    CompilerHost.prototype.writeFile = function (name, text, writeByteOrderMark) {
        throw new Error("Not implemented");
    };
    CompilerHost.prototype.getDefaultLibFileName = function () {
        return "typescript/lib/lib.es6.d.ts";
    };
    CompilerHost.prototype.useCaseSensitiveFileNames = function () {
        return false;
    };
    CompilerHost.prototype.getCanonicalFileName = function (fileName) {
        return fileName;
    };
    CompilerHost.prototype.getCurrentDirectory = function () {
        return "";
    };
    CompilerHost.prototype.getNewLine = function () {
        return "\n";
    };
    CompilerHost.prototype.addFile = function (filename, text, isDefaultLib) {
        if (isDefaultLib === void 0) { isDefaultLib = false; }
        this._files[filename] = ts.createSourceFile(filename, text, this._options.target);
        this._files[filename].isDefaultLib = isDefaultLib;
        logger.debug("added " + filename);
        return this._files[filename];
    };
    CompilerHost.prototype.addResolutionMap = function (filename, map) {
        this._fileResMaps[filename] = map;
    };
    CompilerHost.prototype.resolveModuleNames = function (moduleNames, containingFile) {
        var _this = this;
        return moduleNames.map(function (modName) {
            if (utils_1.isHtml(modName))
                return { resolvedFileName: exports.__HTML_MODULE__ };
            else if (_this._fileResMaps[containingFile])
                return { resolvedFileName: _this._fileResMaps[containingFile][modName] };
            else
                return ts.resolveModuleName(modName, containingFile, _this._options, _this).resolvedModule;
        });
    };
    return CompilerHost;
})();
exports.CompilerHost = CompilerHost;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcGlsZXItaG9zdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9jb21waWxlci1ob3N0LnRzIl0sIm5hbWVzIjpbIkNvbXBpbGVySG9zdCIsIkNvbXBpbGVySG9zdC5jb25zdHJ1Y3RvciIsIkNvbXBpbGVySG9zdC5nZXRFbnVtIiwiQ29tcGlsZXJIb3N0Lm9wdGlvbnMiLCJDb21waWxlckhvc3QuZ2V0U291cmNlRmlsZSIsIkNvbXBpbGVySG9zdC5maWxlRXhpc3RzIiwiQ29tcGlsZXJIb3N0LnJlYWRGaWxlIiwiQ29tcGlsZXJIb3N0LndyaXRlRmlsZSIsIkNvbXBpbGVySG9zdC5nZXREZWZhdWx0TGliRmlsZU5hbWUiLCJDb21waWxlckhvc3QudXNlQ2FzZVNlbnNpdGl2ZUZpbGVOYW1lcyIsIkNvbXBpbGVySG9zdC5nZXRDYW5vbmljYWxGaWxlTmFtZSIsIkNvbXBpbGVySG9zdC5nZXRDdXJyZW50RGlyZWN0b3J5IiwiQ29tcGlsZXJIb3N0LmdldE5ld0xpbmUiLCJDb21waWxlckhvc3QuYWRkRmlsZSIsIkNvbXBpbGVySG9zdC5hZGRSZXNvbHV0aW9uTWFwIiwiQ29tcGlsZXJIb3N0LnJlc29sdmVNb2R1bGVOYW1lcyJdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBWSxFQUFFLFdBQU0sWUFBWSxDQUFDLENBQUE7QUFDakMsdUJBQW1CLFVBQVUsQ0FBQyxDQUFBO0FBQzlCLHNCQUFxQixTQUFTLENBQUMsQ0FBQTtBQUUvQixJQUFJLE1BQU0sR0FBRyxJQUFJLGdCQUFNLENBQUMsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztBQUMvQix1QkFBZSxHQUFHLGlCQUFpQixDQUFDO0FBRStCLENBQUM7QUFFL0U7SUFLQ0Esc0JBQVlBLE9BQVlBO1FBQ3ZCQyxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxPQUFPQSxJQUFJQSxFQUFFQSxDQUFDQTtRQUM5QkEsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsTUFBTUEsR0FBR0EsSUFB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b0JBQVksZUFxR3hCLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvKiAqL1xuaW1wb3J0ICogYXMgdHMgZnJvbSAndHlwZXNjcmlwdCc7XG5pbXBvcnQgTG9nZ2VyIGZyb20gJy4vbG9nZ2VyJztcbmltcG9ydCB7aXNIdG1sfSBmcm9tICcuL3V0aWxzJztcblxubGV0IGxvZ2dlciA9IG5ldyBMb2dnZXIoeyBkZWJ1ZzogZmFsc2UgfSk7XG5leHBvcnQgbGV0IF9fSFRNTF9NT0RVTEVfXyA9IFwiX19odG1sX21vZHVsZV9fXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tYmluZWRPcHRpb25zIGV4dGVuZHMgUGx1Z2luT3B0aW9ucywgdHMuQ29tcGlsZXJPcHRpb25zIHsgfTtcblxuZXhwb3J0IGNsYXNzIENvbXBpbGVySG9zdCBpbXBsZW1lbnRzIHRzLkNvbXBpbGVySG9zdCB7XG5cdHByaXZhdGUgX29wdGlvbnM6IGFueTtcblx0cHJpdmF0ZSBfZmlsZXM6IE1hcDxzdHJpbmcsIHRzLlNvdXJjZUZpbGU+O1xuXHRwcml2YXRlIF9maWxlUmVzTWFwczogTWFwPHN0cmluZywgYW55PjtcblxuXHRjb25zdHJ1Y3RvcihvcHRpb25zOiBhbnkpIHtcblx0XHR0aGlzLl9vcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0XHR0aGlzLl9vcHRpb25zLm1vZHVsZSA9IHRoaXMuZ2V0RW51bSh0aGlzLl9vcHRpb25zLm1vZHVsZSwgdHMuTW9kdWxlS2luZCwgdHMuTW9kdWxlS2luZC5TeXN0ZW0pO1xuXHRcdHRoaXMuX29wdGlvbnMudGFyZ2V0ID0gdGhpcy5nZXRFbnVtKHRoaXMuX29wdGlvbnMudGFyZ2V0LCB0cy5TY3JpcHRUYXJnZXQsIHRzLlNjcmlwdFRhcmdldC5FUzUpO1xuXHRcdHRoaXMuX29wdGlvbnMuanN4ID0gdGhpcy5nZXRFbnVtKHRoaXMuX29wdGlvbnMuanN4LCB0cy5Kc3hFbWl0LCB0cy5Kc3hFbWl0Lk5vbmUpO1xuXHRcdHRoaXMuX29wdGlvbnMuYWxsb3dOb25Uc0V4dGVuc2lvbnMgPSAodGhpcy5fb3B0aW9ucy5hbGxvd05vblRzRXh0ZW5zaW9ucyAhPT0gZmFsc2UpO1xuXHRcdHRoaXMuX29wdGlvbnMuc2tpcERlZmF1bHRMaWJDaGVjayA9ICh0aGlzLl9vcHRpb25zLnNraXBEZWZhdWx0TGliQ2hlY2sgIT09IGZhbHNlKTtcblx0XHR0aGlzLl9vcHRpb25zLm5vUmVzb2x2ZSA9IHRydWU7XG5cblx0XHR0aGlzLl9maWxlcyA9IG5ldyBNYXA8c3RyaW5nLCB0cy5Tb3VyY2VGaWxlPigpO1xuXHRcdHRoaXMuX2ZpbGVSZXNNYXBzID0gbmV3IE1hcDxzdHJpbmcsIGFueT4oKTtcblxuXHRcdC8vIHN1cHBvcnQgZm9yIGltcG9ydGluZyBodG1sIHRlbXBsYXRlcyB1bnRpbFxuXHRcdC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMjcwOSNpc3N1ZWNvbW1lbnQtOTE5Njg5NTAgZ2V0cyBpbXBsZW1lbnRlZFxuXHRcdC8vIG5vdGUgLSB0aGlzIG9ubHkgYWZmZWN0cyB0eXBlLWNoZWNraW5nLCBub3QgcnVudGltZSFcblx0XHR0aGlzLmFkZEZpbGUoX19IVE1MX01PRFVMRV9fLCBcInZhciBfX2h0bWxfXzogc3RyaW5nID0gJyc7IGV4cG9ydCBkZWZhdWx0IF9faHRtbF9fO1wiKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0RW51bTxUPihlbnVtVmFsdWU6IGFueSwgZW51bVR5cGU6IGFueSwgZGVmYXVsdFZhbHVlOiBUKTogVCB7XG5cdFx0aWYgKGVudW1WYWx1ZSA9PSB1bmRlZmluZWQpIHJldHVybiBkZWZhdWx0VmFsdWU7XG5cblx0XHRmb3IgKHZhciBlbnVtUHJvcCBpbiBlbnVtVHlwZSkge1xuXHRcdFx0aWYgKGVudW1Qcm9wLnRvTG93ZXJDYXNlKCkgPT09IGVudW1WYWx1ZS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpIHtcblx0XHRcdFx0aWYgKHR5cGVvZiBlbnVtVHlwZVtlbnVtUHJvcF0gPT09IFwic3RyaW5nXCIpXG5cdFx0XHRcdFx0cmV0dXJuIGVudW1UeXBlW2VudW1UeXBlW2VudW1Qcm9wXV07XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRyZXR1cm4gZW51bVR5cGVbZW51bVByb3BdO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRocm93IG5ldyBFcnJvcihgVW5yZWNvZ25pc2VkIHZhbHVlIFske2VudW1WYWx1ZX1dYCk7XG5cdH1cblxuXHRwdWJsaWMgZ2V0IG9wdGlvbnMoKTogQ29tYmluZWRPcHRpb25zIHtcblx0XHRyZXR1cm4gdGhpcy5fb3B0aW9ucztcblx0fVxuXG5cdHB1YmxpYyBnZXRTb3VyY2VGaWxlKGZpbGVOYW1lOiBzdHJpbmcpOiB0cy5Tb3VyY2VGaWxlIHtcblx0XHRyZXR1cm4gdGhpcy5fZmlsZXNbZmlsZU5hbWVdO1xuXHR9XG5cblx0cHVibGljIGZpbGVFeGlzdHMoZmlsZU5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiAhIXRoaXMuX2ZpbGVzW2ZpbGVOYW1lXTtcblx0fVxuXG5cdHB1YmxpYyByZWFkRmlsZShmaWxlTmFtZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG5cdH1cblxuXHRwdWJsaWMgd3JpdGVGaWxlKG5hbWU6IHN0cmluZywgdGV4dDogc3RyaW5nLCB3cml0ZUJ5dGVPcmRlck1hcms6IGJvb2xlYW4pIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG5cdH1cblxuXHRwdWJsaWMgZ2V0RGVmYXVsdExpYkZpbGVOYW1lKCk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIFwidHlwZXNjcmlwdC9saWIvbGliLmVzNi5kLnRzXCI7XG5cdH1cblxuXHRwdWJsaWMgdXNlQ2FzZVNlbnNpdGl2ZUZpbGVOYW1lcygpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRwdWJsaWMgZ2V0Q2Fub25pY2FsRmlsZU5hbWUoZmlsZU5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIGZpbGVOYW1lO1xuXHR9XG5cblx0cHVibGljIGdldEN1cnJlbnREaXJlY3RvcnkoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gXCJcIjtcblx0fVxuXG5cdHB1YmxpYyBnZXROZXdMaW5lKCk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIFwiXFxuXCI7XG5cdH1cblxuXHRwdWJsaWMgYWRkRmlsZShmaWxlbmFtZTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcsIGlzRGVmYXVsdExpYjogYm9vbGVhbiA9IGZhbHNlKSB7XG5cdFx0dGhpcy5fZmlsZXNbZmlsZW5hbWVdID0gdHMuY3JlYXRlU291cmNlRmlsZShmaWxlbmFtZSwgdGV4dCwgdGhpcy5fb3B0aW9ucy50YXJnZXQpO1xuXHRcdHRoaXMuX2ZpbGVzW2ZpbGVuYW1lXS5pc0RlZmF1bHRMaWIgPSBpc0RlZmF1bHRMaWI7XG5cblx0XHRsb2dnZXIuZGVidWcoYGFkZGVkICR7ZmlsZW5hbWV9YCk7XG5cdFx0cmV0dXJuIHRoaXMuX2ZpbGVzW2ZpbGVuYW1lXTtcblx0fVxuXG5cdHB1YmxpYyBhZGRSZXNvbHV0aW9uTWFwKGZpbGVuYW1lOiBzdHJpbmcsIG1hcDogTWFwPHN0cmluZywgc3RyaW5nPikge1xuXHRcdHRoaXMuX2ZpbGVSZXNNYXBzW2ZpbGVuYW1lXSA9IG1hcDtcblx0fVxuXG5cdHB1YmxpYyByZXNvbHZlTW9kdWxlTmFtZXMobW9kdWxlTmFtZXM6IHN0cmluZ1tdLCBjb250YWluaW5nRmlsZTogc3RyaW5nKTogdHMuUmVzb2x2ZWRNb2R1bGVbXSB7XG5cdFx0cmV0dXJuIG1vZHVsZU5hbWVzLm1hcCgobW9kTmFtZSkgPT4ge1xuXHRcdFx0aWYgKGlzSHRtbChtb2ROYW1lKSlcblx0XHRcdFx0cmV0dXJuIHsgcmVzb2x2ZWRGaWxlTmFtZTogX19IVE1MX01PRFVMRV9fIH07XG5cdFx0XHRlbHNlIGlmICh0aGlzLl9maWxlUmVzTWFwc1tjb250YWluaW5nRmlsZV0pXG5cdFx0XHRcdHJldHVybiB7IHJlc29sdmVkRmlsZU5hbWU6IHRoaXMuX2ZpbGVSZXNNYXBzW2NvbnRhaW5pbmdGaWxlXVttb2ROYW1lXSB9O1xuXHRcdFx0ZWxzZVxuXHRcdFx0XHRyZXR1cm4gdHMucmVzb2x2ZU1vZHVsZU5hbWUobW9kTmFtZSwgY29udGFpbmluZ0ZpbGUsIHRoaXMuX29wdGlvbnMsIHRoaXMpLnJlc29sdmVkTW9kdWxlO1xuXHRcdFx0XHQvLyBcdHRocm93IG5ldyBFcnJvcihgY29udGFpbmluZyBmaWxlICR7Y29udGFpbmluZ0ZpbGV9IGhhcyBub3QgYmVlbiBsb2FkZWRgKTtcblx0XHR9KTtcblx0fVxufVxuIl19